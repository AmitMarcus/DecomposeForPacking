DecomposeForPacking
===================
This is the work of MPG.